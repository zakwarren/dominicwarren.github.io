import{l as r}from"./preact.module.3b40a332.js";var E,c,I,A=0,l=[],w=r.__b,L=r.__r,B=r.diffed,k=r.__c,D=r.unmount;function C(e,t){r.__h&&r.__h(c,e,A||t),A=0;var i=c.__H||(c.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function P(e,t){var i=C(E++,3);!r.__s&&M(i.__H,t)&&(i.__=e,i.__H=t,c.__H.__h.push(i))}function T(){l.forEach(function(e){if(e.__P)try{e.__H.__h.forEach(d),e.__H.__h.forEach(p),e.__H.__h=[]}catch(t){e.__H.__h=[],r.__e(t,e.__v)}}),l=[]}r.__b=function(e){c=null,w&&w(e)},r.__r=function(e){L&&L(e),E=0;var t=(c=e.__c).__H;t&&(t.__h.forEach(d),t.__h.forEach(p),t.__h=[])},r.diffed=function(e){B&&B(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(l.push(t)!==1&&I===r.requestAnimationFrame||((I=r.requestAnimationFrame)||function(i){var s,n=function(){clearTimeout(h),R&&cancelAnimationFrame(s),setTimeout(i)},h=setTimeout(n,100);R&&(s=requestAnimationFrame(n))})(T)),c=null},r.__c=function(e,t){t.some(function(i){try{i.__h.forEach(d),i.__h=i.__h.filter(function(s){return!s.__||p(s)})}catch(s){t.some(function(n){n.__h&&(n.__h=[])}),t=[],r.__e(s,i.__v)}}),k&&k(e,t)},r.unmount=function(e){D&&D(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(d)}catch(i){r.__e(i,t.__v)}};var R=typeof requestAnimationFrame=="function";function d(e){var t=c;typeof e.__c=="function"&&e.__c(),c=t}function p(e){var t=c;e.__c=e.__(),c=t}function M(e,t){return!e||e.length!==t.length||t.some(function(i,s){return i!==e[s]})}class K{constructor(t){this.canvas=document.querySelector(t),this.context=this.canvas.getContext("2d"),this.scoreDisplay=document.querySelector("#score"),this.start=document.querySelector("#start"),this.info=document.querySelector("#info")}clear(){this.context?.clearRect(0,0,this.canvas.width,this.canvas.height)}initStartButton(t){this.start?.addEventListener("click",()=>t(this))}drawScore(t){this.scoreDisplay&&(this.scoreDisplay.innerHTML=t.toString())}drawInfo(t){this.info&&(this.info.innerHTML=t)}drawSprite(t){!t||this.context?.drawImage(t.image,t.pos.x,t.pos.y,t.width,t.height)}drawBricks(t){t.forEach(i=>this.drawSprite(i))}}class q{constructor(t,i,s,n){this.ballSize=t,this.position=i,this.ballImage=new Image,this.ballSize=t,this.position=i,this.speed={x:s,y:-s},this.ballImage.src=n}get width(){return this.ballSize}get height(){return this.ballSize}get pos(){return this.position}get image(){return this.ballImage}changeYDirection(){this.speed.y=-this.speed.y}changeXDirection(){this.speed.x=-this.speed.x}moveBall(){this.pos.x+=this.speed.x,this.pos.y+=this.speed.y}}class W{constructor(t,i,s,n,h){this.speed=t,this.paddleWidth=i,this.paddleHeight=s,this.position=n,this.paddleImage=new Image,this.handleKeyUp=o=>{(o.code==="ArrowLeft"||o.key==="ArrowLeft")&&(this.moveLeft=!1),(o.code==="ArrowRight"||o.key==="ArrowRight")&&(this.moveRight=!1)},this.handleKeyDown=o=>{(o.code==="ArrowLeft"||o.key==="ArrowLeft")&&(this.moveLeft=!0),(o.code==="ArrowRight"||o.key==="ArrowRight")&&(this.moveRight=!0)},this.speed=t,this.paddleWidth=i,this.paddleHeight=s,this.position=n,this.moveLeft=!1,this.moveRight=!1,this.paddleImage.src=h,document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}get width(){return this.paddleWidth}get height(){return this.paddleHeight}get pos(){return this.position}get image(){return this.paddleImage}get isMovingLeft(){return this.moveLeft}get isMovingRight(){return this.moveRight}movePaddle(){this.moveLeft&&(this.position.x-=this.speed),this.moveRight&&(this.position.x+=this.speed)}}class F{isCollidingBrick(t,i){return t.pos.x<i.pos.x+i.width&&t.pos.x+t.width>i.pos.x&&t.pos.y<i.pos.y+i.height&&t.pos.y+t.height>i.pos.y}isCollidingBricks(t,i){let s=!1;return i.forEach((n,h)=>{this.isCollidingBrick(t,n)&&(t.changeYDirection(),n.energy===1?i.splice(h,1):n.energy-=1,s=!0)}),s}checkBarrierCollision(t,i,s){t.pos.x+t.width>i.pos.x&&t.pos.x<i.pos.x+i.width&&t.pos.y+t.height===i.pos.y&&t.changeYDirection(),(t.pos.x>s.canvas.width-t.width||t.pos.x<0)&&t.changeXDirection(),t.pos.y<0&&t.changeYDirection()}}var Y="/assets/paddle.0944322c.png",N="/assets/ball.d8da8de7.png",b="/assets/brick-red.1aa56f27.png",O="/assets/brick-blue.6cb18b4e.png",U="/assets/brick-green.99eb9f61.png",X="/assets/brick-yellow.35fae3a4.png",z="/assets/brick-purple.70f6d8c8.png";const u=document.querySelector("#playField"),g=10,$=20,m=10,f=5,S=u?Math.floor((u.width-g*2)/m)-f:100,x=u?Math.floor((u.height-g*2)/$)-f:30,j=150,H=25,V=450,Z=10,J=5,Q=40,tt=500,et=400,it={1:b,2:U,3:X,4:O,5:z},st={1:1,2:1,3:2,4:2,5:3},nt=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,2,2,2,2,2,2,2,2,0,0,3,3,3,3,3,3,3,3,0,0,0,4,4,4,4,4,4,0,0,0,0,5,5,0,0,5,5,0,0];class ot{constructor(t,i,s,n,h){this.brickWidth=t,this.brickHeight=i,this.position=s,this.brickEnergy=n,this.brickImage=new Image,this.brickWidth=t,this.brickHeight=i,this.position=s,this.brickEnergy=n,this.brickImage.src=h}get width(){return this.brickWidth}get height(){return this.brickHeight}get pos(){return this.position}get energy(){return this.brickEnergy}get image(){return this.brickImage}set energy(t){this.brickEnergy=t}}const rt=()=>nt.reduce((e,t,i)=>{const s=Math.floor((i+1)/m),n=i%m,h=g+n*(S+f),o=g+s*(x+f);return t===0?e:[...e,new ot(S,x,{x:h,y:o},st[t],it[t])]},[]);let y=0;const ht=e=>{e.drawInfo("Game Over!")},ct=e=>{e.drawInfo("You Won!")},G=(e,t,i,s,n)=>{if(e.clear(),e.drawBricks(t),e.drawSprite(i),e.drawSprite(s),s.moveBall(),(i.isMovingLeft&&i.pos.x>0||i.isMovingRight&&i.pos.x<e.canvas.width-i.width)&&i.movePaddle(),n.checkBarrierCollision(s,i,e),n.isCollidingBricks(s,t)&&(y+=1,e.drawScore(y)),s.pos.y>e.canvas.height)return ht(e);if(t.length===0)return ct(e);requestAnimationFrame(()=>G(e,t,i,s,n))},at=e=>{y=0,e.drawScore(0),e.drawInfo("");const t=new F,i=rt(),s=new q(Q,{x:tt,y:et},J,N),n=new W(Z,j,H,{x:V,y:e.canvas.height-H-5},Y);G(e,i,n,s,t)};var _t=0;function a(e,t,i,s,n){var h,o,_={};for(o in t)o=="ref"?h=t[o]:_[o]=t[o];var v={type:e,props:_,key:i,ref:h,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--_t,__source:s,__self:n};if(typeof e=="function"&&(h=e.defaultProps))for(o in h)_[o]===void 0&&(_[o]=h[o]);return r.vnode&&r.vnode(v),v}const ut=()=>(P(()=>{new K("#playField").initStartButton(at)},[]),a("div",{id:"main",className:"main",children:[a("canvas",{id:"playField",width:"1000",height:"600"}),a("img",{id:"background",className:"background",src:"/background.png"}),a("div",{id:"display",children:[a("div",{id:"score"}),a("button",{id:"start",children:"Play"}),a("div",{id:"info",children:"Press play!"})]})]}));export{ut as Albie};
